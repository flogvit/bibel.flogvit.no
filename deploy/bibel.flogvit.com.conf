<VirtualHost *:80>
    ServerName bibel.flogvit.no

    # Redirect all HTTP to HTTPS (after certbot is set up)
    # RewriteEngine On
    # RewriteCond %{HTTPS} off
    # RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

    # Proxy to Next.js
    ProxyPreserveHost On
    ProxyPass / http://localhost:3018/
    ProxyPassReverse / http://localhost:3018/

    # WebSocket support (for hot reload in dev, and future features)
    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} websocket [NC]
    RewriteCond %{HTTP:Connection} upgrade [NC]
    RewriteRule ^/?(.*) ws://localhost:3018/$1 [P,L]

    ErrorLog ${APACHE_LOG_DIR}/bibel.flogvit.no-error.log
    CustomLog ${APACHE_LOG_DIR}/bibel.flogvit.no-access.log combined
</VirtualHost>
